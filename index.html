<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Mapa Conceptual - Modelos de Negocio</title>
  <script src="https://unpkg.com/gojs@2.3.15/release/go.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f2f6fc;
      margin: 0;
      padding: 0;
    }
    header {
      background: #004aad;
      color: white;
      text-align: center;
      padding: 1rem;
    }
    nav {
      display: flex;
      justify-content: center;
      background: #e6eefc;
      padding: 1rem;
      gap: 1rem;
    }
    nav button {
      padding: 0.5rem 1rem;
      border: none;
      background: #cce0ff;
      font-weight: bold;
      border-radius: 6px;
      cursor: pointer;
    }
    nav button:hover {
      background: #aacbff;
    }
    #diagramDiv {
      width: 100%;
      height: 80vh;
      border-top: 2px solid #ccc;
      position: relative;
    }
    .controls {
      text-align: center;
      padding: 1rem;
    }
    .controls button {
      background: #004aad;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 6px;
      cursor: pointer;
      margin: 0.5rem;
    }
    /* Popup modal estilos */
    #descPopup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      border-radius: 10px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.2);
      padding: 1.5rem;
      max-width: 350px;
      display: none;
      z-index: 1000;
    }
    #descPopup p {
      margin: 0 0 1rem 0;
    }
    #descPopup button {
      background: #004aad;
      color: white;
      border: none;
      padding: 0.4rem 0.8rem;
      border-radius: 5px;
      cursor: pointer;
    }
    #overlay {
      position: fixed;
      top:0; left:0; right:0; bottom:0;
      background: rgba(0,0,0,0.3);
      display: none;
      z-index: 900;
    }
  </style>
</head>
<body>

  <header>
    <h1>üß† Mapa Conceptual Interactivo - Modelos de Negocio</h1>
  </header>

  <nav>
    <button onclick="loadModel('disruptivo')">üí° Disruptivo</button>
    <button onclick="loadModel('cola')">üì¶ Cola Larga</button>
    <button onclick="loadModel('plataforma')">üåê Plataforma Multilateral</button>
  </nav>

  <div class="controls">
    <button onclick="saveAsImage()">üì∏ Exportar como Imagen</button>
    <button onclick="window.print()">üñ®Ô∏è Imprimir como PDF</button>
  </div>

  <div id="diagramDiv"></div>

  <!-- Popup para mostrar descripci√≥n -->
  <div id="overlay"></div>
  <div id="descPopup">
    <p id="descText"></p>
    <button onclick="closePopup()">Cerrar</button>
  </div>

  <script>
    const $ = go.GraphObject.make;
    const diagram = $(go.Diagram, "diagramDiv", {
      layout: $(go.ForceDirectedLayout),
      "undoManager.isEnabled": true
    });

    diagram.nodeTemplate =
      $(go.Node, "Auto",
        {
          resizable: true, resizeObjectName: "SHAPE",
          click: (e, node) => {
            // Solo clic: mostrar descripci√≥n en popup
            if (e.clickCount === 1) {
              showDescription(node.data);
            }
          },
          doubleClick: (e, node) => {
            // Doble clic: editar descripci√≥n
            e.diagram.currentTool.doCancel(); // prevenir zoom/doble clic default
            const nota = prompt("Edita la descripci√≥n:", node.data.desc || "");
            if (nota !== null) {
              diagram.model.startTransaction("edit");
              diagram.model.setDataProperty(node.data, "desc", nota);
              diagram.model.commitTransaction("edit");
              localStorage.setItem(node.data.key, nota);
              closePopup();
            }
          }
        },
        $(go.Shape, "RoundedRectangle",
          { name: "SHAPE", fill: "#e6f0ff", stroke: "#004aad", strokeWidth: 2 }),
        $(go.TextBlock,
          { margin: 8, font: "bold 13px sans-serif", editable: false },
          new go.Binding("text", "text"))
      );

    diagram.linkTemplate =
      $(go.Link,
        { routing: go.Link.AvoidsNodes, corner: 5 },
        $(go.Shape),
        $(go.Shape, { toArrow: "Standard" })
      );

    // Popup y overlay control
    const popup = document.getElementById('descPopup');
    const overlay = document.getElementById('overlay');
    const descText = document.getElementById('descText');

    function showDescription(data) {
      descText.textContent = data.desc || "Sin descripci√≥n disponible.";
      popup.style.display = 'block';
      overlay.style.display = 'block';
    }
    function closePopup() {
      popup.style.display = 'none';
      overlay.style.display = 'none';
    }
    overlay.addEventListener('click', closePopup);

    // Modelos con datos (informaci√≥n completa del PDF y emojis)
    const modelos = {
      disruptivo: {
        nodeDataArray: [
          { key: "D0", text: "üí° Modelo Disruptivo", desc: "Rompe esquemas tradicionales con tecnolog√≠a." },
          { key: "D1", text: "üöÄ Caracter√≠sticas", desc: "Transformaci√≥n cultural, innovaci√≥n acelerada, nuevas demandas." },
          { key: "D2", text: "ü§ñ Tecnolog√≠as", desc: "IA, IoT, Blockchain." },
          { key: "D3", text: "üîÑ Eliminaci√≥n de Intermediarios", desc: "Facilita el contacto directo con el consumidor." },
          { key: "D4", text: "üìà Estimula la Competencia", desc: "Cambia las reglas del juego en el mercado." },
          { key: "D5", text: "üè¢ Ejemplos", desc: "Spotify, Netflix, Uber, Amazon, Sharoo." }
        ],
        linkDataArray: [
          { from: "D0", to: "D1" },
          { from: "D0", to: "D2" },
          { from: "D0", to: "D3" },
          { from: "D0", to: "D4" },
          { from: "D0", to: "D5" }
        ]
      },

      cola: {
        nodeDataArray: [
          { key: "C0", text: "üì¶ Modelo Cola Larga", desc: "Vende muchos productos de baja demanda." },
          { key: "C1", text: "üìä Rompe Pareto", desc: "80% de los ingresos no proviene solo del 20%." },
          { key: "C2", text: "üåê Internet", desc: "Permite alcance y diversidad global." },
          { key: "C3", text: "üí∏ Costos Bajos", desc: "Distribuci√≥n/almacenamiento digital." },
          { key: "C4", text: "üé® Personalizaci√≥n", desc: "Adaptado a nichos minoritarios." },
          { key: "C5", text: "üè¢ Ejemplos", desc: "Amazon (libros), Netflix (indie), LEGO (kits personalizados)." }
        ],
        linkDataArray: [
          { from: "C0", to: "C1" },
          { from: "C0", to: "C2" },
          { from: "C0", to: "C3" },
          { from: "C0", to: "C4" },
          { from: "C0", to: "C5" }
        ]
      },

      plataforma: {
        nodeDataArray: [
          { key: "P0", text: "üåê Modelo Plataforma", desc: "Conecta grupos interdependientes para generar valor." },
          { key: "P1", text: "üë• Interacci√≥n", desc: "Segmentos que se benefician unos de otros." },
          { key: "P2", text: "üì° Efecto Red", desc: "M√°s usuarios = m√°s valor." },
          { key: "P3", text: "üí∞ Costos Bajos", desc: "No requiere fabricar o almacenar productos." },
          { key: "P4", text: "üìà Escalabilidad", desc: "Puede crecer r√°pidamente." },
          { key: "P5", text: "üè¢ Ejemplos", desc: "Amazon, eBay, Airbnb, Uber, Facebook, Instagram." }
        ],
        linkDataArray: [
          { from: "P0", to: "P1" },
          { from: "P0", to: "P2" },
          { from: "P0", to: "P3" },
          { from: "P0", to: "P4" },
          { from: "P0", to: "P5" }
        ]
      }
    };

    function loadModel(tipo) {
      diagram.model = go.Model.fromJson(modelos[tipo]);
      diagram.nodes.each(node => {
        const nota = localStorage.getItem(node.data.key);
        if (nota) diagram.model.setDataProperty(node.data, "desc", nota);
      });
      closePopup();
    }

    function saveAsImage() {
      const img = diagram.makeImageData({ scale: 1, background: "white" });
      const link = document.createElement("a");
      link.download = "mapa_modelo.png";
      link.href = img;
      link.click();
    }

    // Carga inicial
    loadModel("disruptivo");
  </script>

</body>
</html>


